# This is a test bundle that can be used as a dependency
# TODO(PEP003): Do not depend on this bundle from mybuns, and move testcases like installerImage out of here
schemaVersion: 1.0.0
name: mydb
version: 0.1.0
description: "A test bundle dependency"
registry: localhost:5000

parameters:
  - name: database
    type: string
    default: "mydb"
  - name: collation
    type: string
    default: "Latin1_General_100_CS_AS"
  - name: logLevel
    type: string

credentials:
  - name: token
    env: CLOUD_TOKEN

outputs:
  - name: connStr
    type: file
    path: /cnab/app/connection-string.txt
    applyTo:
      - install
      - upgrade

mixins:
  - exec

dry-run:
  - exec:
      command: echo
      arguments:
        - "ready to install mydb"

install:
  - exec:
      command: echo
      arguments:
        - "installing mydb"
  - exec:
      command: echo
      arguments:
        - "database: ${ bundle.parameters.database }"
  - exec:
      description: "Debug"
      command: echo
      arguments:
        - "image: ${ bundle.installerImage }"

status:
  - exec:
      command: echo
      arguments:
        - "mydb is looking great!"

upgrade:
  - exec:
      command: echo
      arguments:
        - "upgrading mydb"

uninstall:
  - exec:
      command: echo
      arguments:
        - "uninstalling mydb"
